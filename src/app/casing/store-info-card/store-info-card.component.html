<div class="infoCard">
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <strong>{{store.getLabel()}}</strong>
      </mat-card-title>
      <mat-card-subtitle *ngIf="store.currentStoreStatus != null">
        {{store.currentStoreStatus.status}}
      </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <div style="display:flex; justify-content: space-between;">
        <div>
          <p>{{store.site.getIntersection()}}</p>
          <p>{{store.site.address1}}</p>
          <p>{{store.site.getPrincipality()}}</p>
        </div>
      </div>
    </mat-card-content>
    <mat-card-actions>
      <button mat-button [disabled]="disableActions" [matMenuTriggerFor]="markerMoreMenu">
        <i class="fas fa-ellipsis-v"></i>&nbsp;More
      </button>
      <!-- TODO Enable Pinning-->
      <button mat-button [disabled]="true || disableActions" (click)="pinLocation()">
        <i class="fas fa-thumbtack"></i>&nbsp;Pin
      </button>
      <button mat-button [disabled]="disableActions" (click)="goToSiteOverview()">
        <i class="fas fa-pencil-alt"></i>&nbsp;Edit
      </button>
    </mat-card-actions>
  </mat-card>
</div>

<mat-menu #markerMoreMenu="matMenu" [overlapTrigger]="false">
  <div mat-menu-item>Store ID: #{{store.id}}</div>
  <button mat-menu-item (click)="onMoveStore.emit(store)">
    <i class="fas fa-arrows-alt"></i>&nbsp;Move
  </button>
  <button mat-menu-item [disabled]="true"><i class="far fa-clock"></i>&nbsp;History</button>
  <button mat-menu-item (click)="setDuplicateFlag(true)" *ngIf="!store.site.duplicate">
    <i class="fas fa-flag"></i>&nbsp;Flag as Duplicate
  </button>
  <button mat-menu-item (click)="setDuplicateFlag(false)" *ngIf="store.site.duplicate">
    <i class="fas fa-flag"></i>&nbsp;Unflag as Duplicate
  </button>
  <button mat-menu-item (click)="assignStoreToUser(null)" *ngIf="store.site.assignee != null">
    <i class="fas fa-ban"></i>&nbsp;Unassign
  </button>
  <button mat-menu-item (click)="openAssignmentDialog()">
    <i class="fas fa-user"></i>&nbsp;Assign to Analyst
  </button>
</mat-menu>
