<mat-sidenav-container id="casing-dash-container">
  <mat-sidenav mode="over" [(opened)]="sideNavIsOpen" class="casing-side-nav">
    <mat-nav-list role="list">
      <h3 mat-subheader>Project</h3>
      <mat-list-item routerLink="/casing/projects">Manage Projects</mat-list-item>
      <mat-list-item *ngIf="casingDashboardService.selectedProject == null"
                     (click)="casingDashboardService.openProjectSelectionDialog()">Select Project
      </mat-list-item>
      <mat-list-item *ngIf="casingDashboardService.selectedProject != null"
                     [matMenuTriggerFor]="selectedProjectMenu">
        {{casingDashboardService.selectedProject.projectName}}&nbsp;<i class="fas fa-chevron-right"></i>
      </mat-list-item>
      <mat-divider></mat-divider>
      <h3 mat-subheader>Sites</h3>
      <mat-list-item role="listitem" [matMenuTriggerFor]="markerTypeMenu">
        <h4 mat-line>Marker Type</h4>&nbsp;<i class="fas fa-chevron-right"></i>
        <p mat-line>{{mapService.getMarkerType().valueOf()}}</p>
      </mat-list-item>
      <mat-list-item role="listitem" (click)="createNewLocation()">Create New Site</mat-list-item>
      <mat-list-item role="listitem" (click)="multiSelect()">Multi Select</mat-list-item>
      <mat-divider></mat-divider>
      <h3 mat-subheader>Geolocation</h3>
      <mat-list-item role="listitem" (click)="findMe()">Find Me</mat-list-item>
      <mat-list-item *ngIf="mode === modeType.FOLLOWING" role="listitem" (click)="deactivateFollowMe()">
        <h4 mat-line>Follow Me</h4>
        <p mat-line>Deactivate</p>
      </mat-list-item>
      <mat-list-item *ngIf="mode !== modeType.FOLLOWING" role="listitem" (click)="activateFollowMe()">
        <h4 mat-line>Follow Me</h4>
        <p mat-line>Activate</p>
      </mat-list-item>
    </mat-nav-list>
  </mat-sidenav>
  <mat-sidenav-content>
    <form class="box">
      <mds-map #casingMap class="row content" (ready)="onMapReady($event)"></mds-map>
      <div id="infoCard" *ngIf="showCard">
        <mat-card>
          <mat-card-header>
            <mat-card-title>
              <strong>{{selectedSite.getLabel()}}</strong>
            </mat-card-title>
            <mat-card-subtitle>{{selectedSite.getActiveStore().currentStoreStatus}}</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <div style="display:flex; justify-content: space-between;">
              <div>
                <p>{{selectedSite.getIntersection()}}</p>
                <p>{{selectedSite.address1}}</p>
                <p>{{selectedSite.getPrincipality()}}</p>
              </div>
              <div>
                <p>Site #{{selectedSite.id}}</p>
                <p *ngIf="selectedSite.getActiveStore().latestSalesArea != null">
                  {{selectedSite.getActiveStore().latestSalesArea / 1000 | number}}k sqft
                </p>
                <p *ngIf="selectedSite.getActiveStore().latestVolume != null">
                  ${{selectedSite.getActiveStore().latestVolume / 1000 | number}}k
                </p>
              </div>
            </div>
          </mat-card-content>
          <mat-card-actions disabled="true">
            <button mat-button [disabled]="mode === modeType.MOVING_SITE" [matMenuTriggerFor]="markerMoreMenu">
              <i class="fas fa-ellipsis-v"></i>&nbsp;More
            </button>
            <button mat-button [disabled]="mode === modeType.MOVING_SITE" (click)="pinLocation()">
              <i class="fas fa-thumb-tack"></i>&nbsp;Pin
            </button>
            <button mat-button [disabled]="mode === modeType.MOVING_SITE" (click)="goToLocationOverview()">
              <i class="fas fa-pencil"></i>&nbsp;Edit
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
      <mat-toolbar *ngIf="mode === modeType.FOLLOWING" class="row footer flex-space-between" color="primary">
        <div></div>
        <div>
          <button mat-raised-button color="accent" (click)="deactivateFollowMe()">Stop Follow Me</button>
        </div>
        <div></div>
      </mat-toolbar>
      <mat-toolbar *ngIf="mode === modeType.MOVING_SITE" class="row footer flex-space-between" color="primary">
        <div>
          <button mat-raised-button color="accent" (click)="cancelSiteMove()">Cancel</button>
        </div>
        <div>
          Drag Marker
        </div>
        <div>
          <button mat-raised-button color="accent" (click)="saveSiteMove()">Save</button>
        </div>
      </mat-toolbar>
      <mat-toolbar *ngIf="mode === modeType.MULTI_SELECT" class="row footer flex-space-between" color="primary">
        <div>
          <button mat-raised-button color="warn" (click)="cancelMultiSelect()">Cancel</button>
        </div>
        <div>
          <button mat-mini-fab [mat-menu-trigger-for]="multiSelectToolsMenu" color="primary">
            <i *ngIf="multiSelectTool === multiSelectToolTypes.CLICK" class="far fa-hand-pointer"></i>
            <i *ngIf="multiSelectTool === multiSelectToolTypes.CIRCLE" class="far fa-circle"></i>
            <i *ngIf="multiSelectTool === multiSelectToolTypes.RECTANGLE" class="far fa-square"></i>
            <i *ngIf="multiSelectTool === multiSelectToolTypes.POLYGON" class="far fa-star"></i>
          </button>
        </div>
        <div>
          <button mat-mini-fab [mat-menu-trigger-for]="multiSelectModeMenu" color="primary">
            <i *ngIf="multiSelectMode === multiSelectModes.SELECT" class="fas fa-plus"></i>
            <i *ngIf="multiSelectMode === multiSelectModes.DESELECT" class="fas fa-minus"></i>
          </button>
        </div>
        <div>
          <button mat-raised-button color="accent">({{mapService.selectedMappables.length}})&nbsp;Actions</button>
        </div>
      </mat-toolbar>
      <mat-toolbar *ngIf="mode === modeType.CREATING_SITE" class="row footer flex-space-between" color="primary">
        <div>
          <button mat-raised-button color="warn" (click)="cancelLocationCreation()">Cancel</button>
        </div>
        <div>
          <span>Drag Pin</span>
        </div>
        <div>
          <button mat-raised-button color="accent" (click)="editNewLocation()">Edit Details</button>
        </div>
      </mat-toolbar>
      <mat-toolbar *ngIf="mode === modeType.DEFAULT" class="row footer flex-space-between" color="primary">
        <div>
          <button mat-mini-fab color="primary" (click)="sideNavIsOpen = !sideNavIsOpen">
            <i class="fas fa-ellipsis-v"></i>
          </button>
        </div>
        <div>
          <button mat-mini-fab color="primary">
            <i class="fas fa-search"></i>
          </button>
        </div>
        <div>
          <button mat-mini-fab color="primary">
            <i class="fas fa-filter"></i>
          </button>
        </div>
        <div>
          <button mat-mini-fab color="primary" routerLink="site-list">
            <i class="fas fa-list"></i>
          </button>
        </div>
      </mat-toolbar>
    </form>
  </mat-sidenav-content>
</mat-sidenav-container>

<mat-menu #selectedProjectMenu="matMenu" [overlapTrigger]="false" xPosition="after">
  <button mat-menu-item (click)="casingDashboardService.openProjectSelectionDialog()">Change Selected Project</button>
  <button mat-menu-item (click)="casingDashboardService.navigateToProjectSummary()">View Summary</button>
  <button mat-menu-item (click)="casingDashboardService.navigateToProjectDetail()">Edit</button>
  <button mat-menu-item *ngIf="!showingBoundaries"
          (click)="toggleSelectedProjectBoundaries(true)">Show Boundaries
  </button>
  <button mat-menu-item *ngIf="showingBoundaries"
          (click)="toggleSelectedProjectBoundaries(false)">Hide Boundaries
  </button>
</mat-menu>

<mat-menu #markerTypeMenu="matMenu" [overlapTrigger]="false">
  <button mat-menu-item (click)="mapService.setMarkerType(markerType.PIN)">{{markerType.PIN.valueOf()}}</button>
  <button mat-menu-item (click)="mapService.setMarkerType(markerType.LABEL)">{{markerType.LABEL.valueOf()}}</button>
  <button mat-menu-item (click)="mapService.setMarkerType(markerType.LOGO)">{{markerType.LOGO.valueOf()}}</button>
</mat-menu>

<mat-menu #markerMoreMenu="matMenu" [overlapTrigger]="false">
  <button mat-menu-item (click)="moveSite()"><i class="fas fa-arrows"></i>&nbsp;Move</button>
  <button mat-menu-item><i class="far fa-clock"></i>&nbsp;History</button>
</mat-menu>

<mat-menu #multiSelectToolsMenu="matMenu" [overlapTrigger]="false">
  <button mat-menu-item (click)="setMultiSelectTool(multiSelectToolTypes.CLICK)">
    <i class="far fa-hand-pointer"></i>&nbsp;Click
  </button>
  <button mat-menu-item (click)="setMultiSelectTool(multiSelectToolTypes.RECTANGLE)">
    <i class="far fa-square"></i>&nbsp;Rectangle
  </button>
  <button mat-menu-item (click)="setMultiSelectTool(multiSelectToolTypes.CIRCLE)">
    <i class="far fa-circle"></i>&nbsp;Circle
  </button>
  <button mat-menu-item (click)="setMultiSelectTool(multiSelectToolTypes.POLYGON)">
    <i class="far fa-star"></i>&nbsp;Polygon
  </button>
</mat-menu>

<mat-menu #multiSelectModeMenu="matMenu" [overlapTrigger]="false">
  <button mat-menu-item (click)="setMultiSelectMode(multiSelectModes.SELECT)">
    <i class="fas fa-plus-circle"></i>&nbsp;Select
  </button>
  <button mat-menu-item (click)="setMultiSelectMode(multiSelectModes.DESELECT)">
    <i class="fas fa-minus-circle"></i>&nbsp;Deselect
  </button>
</mat-menu>
