<mat-horizontal-stepper [linear]='true' #stepper style="padding-bottom: 50px;">
  <ng-template matStepperIcon="edit">
    <i class="fas fa-pencil-alt"></i>
  </ng-template>
  <ng-template matStepperIcon="done">
    <i class="fas fa-check"></i>
  </ng-template>
  <mat-step [completed]="!reportUploadForm.invalid && htmlAsJson">
    <ng-template matStepLabel>Import Data</ng-template>
    <div class="report-upload-wrapper">
      <form #reportUploadForm="ngForm">
        <mat-form-field>
          <input required matInput name="analyst" type="text" [ngModel]="interface.analyst">
          <mat-hint>Analyst Full Name</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="retailerName" type="text" [ngModel]="interface.retailerName">
          <mat-hint>Retailer Name</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="type" type="text" [ngModel]="interface.type">
          <mat-hint>Type</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="siteNumber" type="text" [ngModel]="interface.siteNumber">
          <mat-hint>Site Number</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="storeAddress" type="text" [ngModel]="interface.storeAddress">
          <mat-hint>Store Address</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="state" type="text" [ngModel]="interface.state">
          <mat-hint>State</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="modelName" type="text" [ngModel]="interface.modelName">
          <mat-hint>Model Name</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="fieldResDate" type="date" [ngModel]="interface.fieldResDate | date:'yyyy-MM-dd'">
          <mat-hint>Field Res Date</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="firstYearEndingMonthYear" type="month" [ngModel]="interface.firstYearEndingMonthYear | date:'yyyy-MM'">
          <mat-hint>First Year Ending Date</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="reportDate" type="date" [ngModel]="interface.reportDate | date:'yyyy-MM-dd'">
          <mat-hint>Report Date</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="projectNumber" type="number" [ngModel]="interface.projectNumber">
          <mat-hint>Project Number</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput min="1950" max="2050" name="opens" type="number" [ngModel]="interface.opens">
          <mat-hint>Opens</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="demographicDataYear" step="1" max="2050" min="1950" type="number" [ngModel]="interface.demographicDataYear">
          <mat-hint>Demographic Data Year</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="inflationRate" step="0.1" min="0" type="number" [ngModel]="interface.inflationRate">
          <mat-hint>Inflation Rate</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="secondYearAcceptance" step="0.1" min="0" type="number" [ngModel]="interface.secondYearAcceptance">
          <mat-hint>Second Year Acceptance</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <input required matInput name="thirdYearAcceptance" step="0.1" min="0" type="number" [ngModel]="interface.thirdYearAcceptance">
          <mat-hint>Third Year Acceptance</mat-hint>
        </mat-form-field>
        <div class="submit">
          <button type="button" mat-flat-button [color]="htmlFile ? 'primary' : 'warn'" (click)="htmlFileInput.click()" [disabled]="compilingJson || reportUploadForm.invalid"><i class="fas fa-spinner fa-spin" *ngIf="compilingJson"></i> {{compilingJson ? ' Fetching Data From Server': 'Upload HTML File'}}</button>
          <input hidden type="file" accept=".html" #htmlFileInput (change)="readFile($event, reportUploadForm)" />
          <span style="margin-left:20px;" *ngIf="htmlAsJson"><i class="fas fa-check-circle" style="color:green;"></i> {{htmlFile.name}}</span>
          <br />
          <button [color]="!reportUploadForm.invalid && htmlAsJson ? 'primary' : 'warn'" [disabled]="reportUploadForm.invalid || !htmlAsJson" mat-flat-button matStepperNext (click)="generateTables()" style="margin-top:20px;">Generate Tables From Data</button>
        </div>
      </form>

    </div>
  </mat-step>
  <mat-step>
    <ng-template matStepLabel>Preview Tables</ng-template>
  </mat-step>
</mat-horizontal-stepper>